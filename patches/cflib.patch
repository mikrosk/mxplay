Index: cflib.h
===================================================================
RCS file: /mint/lib/cflib/cflib.h,v
retrieving revision 1.8
diff -u -r1.8 cflib.h
--- cflib.h	16 Oct 2005 08:56:16 -0000	1.8
+++ cflib.h	27 Dec 2012 17:53:02 -0000
@@ -502,6 +502,8 @@
 
 WDIALOG	*create_wdial	(OBJECT *tree, OBJECT *icon, short edit_obj,
 			 WDIAL_OCB open_cb, WDIAL_XCB exit_cb);
+WDIALOG	*create_wdial_kind (OBJECT *tree, OBJECT *icon, short edit_obj,
+			 WDIAL_OCB open_cb, WDIAL_XCB exit_cb, short win_kind);
 void	delete_wdial	(WDIALOG *wd);
 void	open_wdial	(WDIALOG *wd, short pos_x, short pos_y);
 void	close_wdial	(WDIALOG *wd);
Index: file_split_filename.c
===================================================================
RCS file: /mint/lib/cflib/file_split_filename.c,v
retrieving revision 1.1
diff -u -r1.1 file_split_filename.c
--- file_split_filename.c	21 Sep 2000 11:23:09 -0000	1.1
+++ file_split_filename.c	27 Dec 2012 17:53:02 -0000
@@ -31,9 +31,30 @@
 split_filename (char *fullname, char *path, char *name)
 {
 	char *str;
+	char *str1;
+	char *str2;
 
-	str = strrchr (fullname, '\\');
-
+	str1 = strrchr (fullname, '\\');
+	str2 = strrchr (fullname, '/');
+	
+	/* check for mixed name */
+	if( str1 != NULL && str2 != NULL )
+	{
+		if( strcmp( str1, str2 ) > 0 )
+		{
+			/* str1 is longer => '\' isn't the last one */
+			str = str2;
+		}
+		else
+		{
+			str = str1;
+		}
+	}
+	else
+	{
+		str = str1 != NULL ? str1 : str2;
+	}
+	
 	if (path != NULL)
 		path[0] = '\0';	/* schadet nix */
 	if (name != NULL)
Index: objc_get_flag.c
===================================================================
RCS file: /mint/lib/cflib/objc_get_flag.c,v
retrieving revision 1.2
diff -u -r1.2 objc_get_flag.c
--- objc_get_flag.c	17 Feb 2001 01:28:32 -0000	1.2
+++ objc_get_flag.c	27 Dec 2012 17:53:02 -0000
@@ -30,5 +30,5 @@
 short
 get_flag (OBJECT *tree, short obj, short flag)
 {
-	return (tree[obj].ob_flags & flag);
+	return( ( tree[obj].ob_flags & flag ) != 0 ? 1 : 0 );	/* if present, return TRUE */
 }
Index: objc_get_state.c
===================================================================
RCS file: /mint/lib/cflib/objc_get_state.c,v
retrieving revision 1.2
diff -u -r1.2 objc_get_state.c
--- objc_get_state.c	17 Feb 2001 01:28:33 -0000	1.2
+++ objc_get_state.c	27 Dec 2012 17:53:02 -0000
@@ -30,5 +30,5 @@
 short
 get_state (OBJECT *tree, short obj, short state)
 {
-	return (tree[obj].ob_state & state);
+	return( ( tree[obj].ob_state & state ) != 0 ? 1 : 0 );	/* if present, return TRUE */
 }
Index: wdial_create.c
===================================================================
RCS file: /mint/lib/cflib/wdial_create.c,v
retrieving revision 1.2
diff -u -r1.2 wdial_create.c
--- wdial_create.c	17 Feb 2001 01:28:36 -0000	1.2
+++ wdial_create.c	27 Dec 2012 17:53:02 -0000
@@ -1,27 +1,27 @@
 /*
  * CFLIB, a GEM library for ATARI/TOS
  * Copyright (C) 1999, 2000 Christian Felsch
- * 
+ *
  * Modified for FreeMiNT CVS by Frank Naumann <fnaumann@freemint.de>
- * 
+ *
  * Please send suggestions, patches or bug reports to me or
  * the MiNT mailing list.
- * 
- * 
+ *
+ *
  * This library is free software; you can redistribute it and/or
  * modify it under the terms of the GNU Lesser General Public
  * License as published by the Free Software Foundation; either
  * version 2.1 of the License, or (at your option) any later version.
- * 
+ *
  * This library is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  * Lesser General Public License for more details.
- * 
+ *
  * You should have received a copy of the GNU Lesser General Public
  * License along with this library; if not, write to the Free Software
  * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307  USA
- * 
+ *
  */
 
 #include "wdial.h"
@@ -31,12 +31,17 @@
  * Dialog vorbereiten.
  */
 WDIALOG *
-create_wdial (OBJECT *tree, OBJECT *icon, short edit_obj,
-	      WDIAL_OCB open_cb, WDIAL_XCB exit_cb)
+create_wdial_kind (OBJECT *tree, OBJECT *icon, short edit_obj,
+		   WDIAL_OCB open_cb, WDIAL_XCB exit_cb, short win_kind)
 {
 	WDIALOG *new;
 	short d;
 
+	if( icon == NULL )
+	{
+		win_kind &= SMALLER;	/* remove smaller element if no icon */
+	}
+
 	new = cf_malloc (sizeof (WDIALOG), "create_wdial", FALSE);
 	if (new != NULL)
 	{
@@ -48,13 +53,10 @@
 		new->icon = icon;
 		new->mode = 0;
 		new->win_handle = -1;
-		if (new->icon == NULL)
-			new->win_kind = (NAME | MOVER | CLOSER);
-		else
-			new->win_kind = (NAME | MOVER | CLOSER | SMALLER);
+		new->win_kind = win_kind;
 
 		/*
-		 * Titelzeile suchen und als Fenstertitel merken. 
+		 * Titelzeile suchen und als Fenstertitel merken.
 		 */
 		if (get_magx_obj (tree, 1) == MX_UNDERLINE)
 		{
@@ -89,3 +91,17 @@
 
 	return new;
 }
+
+WDIALOG *
+create_wdial (OBJECT *tree, OBJECT *icon, short edit_obj,
+	      WDIAL_OCB open_cb, WDIAL_XCB exit_cb)
+{
+	short win_kind;
+
+	if (icon == NULL)
+		win_kind = (NAME | MOVER | CLOSER);
+	else
+		win_kind = (NAME | MOVER | CLOSER | SMALLER );
+
+	return create_wdial_kind (tree, icon, edit_obj, open_cb, exit_cb, win_kind);
+}
Index: wdial_redraw_wdobj.c
===================================================================
RCS file: /mint/lib/cflib/wdial_redraw_wdobj.c,v
retrieving revision 1.2
diff -u -r1.2 wdial_redraw_wdobj.c
--- wdial_redraw_wdobj.c	17 Feb 2001 01:28:37 -0000	1.2
+++ wdial_redraw_wdobj.c	27 Dec 2012 17:53:02 -0000
@@ -32,7 +32,7 @@
 {
 	GRECT r;
 
-	if (wd != NULL && !(wd->mode & WD_ICON) && !(wd->mode & WD_SHADE))
+	if (wd != NULL && ( wd->mode & WD_OPEN ) != 0 )
 	{
 		get_objframe (wd->tree, obj, &r);
 		draw_wdial (wd, ROOT, MAX_DEPTH, r.g_x, r.g_y, r.g_w, r.g_h);
